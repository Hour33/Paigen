try {
    /* 1️⃣ GET USERS */
    const checkRes = await fetch(SHEETY_URL);
    const checkData = await checkRes.json();
    const users = checkData.paigen1 || [];

    const duplicate = users.some(u => u.phone === phone);

    if (duplicate) {
      alert("Phone number already registered");
      btn.disabled = false;
      btn.textContent = "Sign up now";
      return;
    }

    /* 2️⃣ SAVE USER */
    btn.textContent = "Saving...";

    const saveRes = await fetch(SHEETY_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        paigen1: {
          phone: phone,
          password: password
        }
      })
    });

    if (!saveRes.ok) {
      alert("Registration failed");
      btn.disabled = false;
      btn.textContent = "Sign up now";
      return;
    }

    /* 3️⃣ SUCCESS */
    alert("Registered successfully!");
    window.location.href = "login.html";

  } catch (err) {
    console.error(err);
    alert("Network error");
    btn.disabled = false;
    btn.textContent = "Sign up now";
  }
};
</script>

</body>
</html>
